{
  "id": "oc-dep-audit",
  "name": "Cross-Repo Dependency Audit",
  "description": "Audits dependency manifests across all Tinyland repos to find version divergence (same package, different versions) and known CVEs. Builds a cross-repo dependency graph and flags inconsistencies.",
  "agent": "openclaw",
  "trigger": {
    "schedule": "0 2 * * 1",
    "event": "manual"
  },
  "targets": [
    {
      "forge": "github",
      "org": "tinyland-inc",
      "repo": "remote-juggler",
      "branch": "main"
    },
    {
      "forge": "github",
      "org": "tinyland-inc",
      "repo": "tinyland.dev",
      "branch": "main"
    },
    {
      "forge": "github",
      "org": "tinyland-inc",
      "repo": "outbot-ci",
      "branch": "main"
    },
    {
      "forge": "github",
      "org": "tinyland-inc",
      "repo": "tinyland-auth",
      "branch": "main"
    },
    {
      "forge": "github",
      "org": "tinyland-inc",
      "repo": "tinyland-a11y-engine",
      "branch": "main"
    },
    {
      "forge": "github",
      "org": "tinyland-inc",
      "repo": "tinyland-otel",
      "branch": "main"
    },
    {
      "forge": "github",
      "org": "tinyland-inc",
      "repo": "tinyland-threat-detection",
      "branch": "main"
    },
    {
      "forge": "github",
      "org": "tinyland-inc",
      "repo": "pp",
      "branch": "main"
    },
    {
      "forge": "github",
      "org": "tinyland-inc",
      "repo": "lab",
      "branch": "main"
    },
    {
      "forge": "github",
      "org": "tinyland-inc",
      "repo": "tinyland-cleanup",
      "branch": "main"
    }
  ],
  "tools": [
    "juggler_audit_log",
    "juggler_campaign_status",
    "juggler_setec_get",
    "juggler_setec_put",
    "github_fetch"
  ],
  "process": [
    "For each target repo: call github_fetch(owner, repo, path) to retrieve dependency manifests. Try package.json, go.mod, Cargo.toml, and pyproject.toml for each repo. The GitHub token is resolved automatically. Skip files that return 404 or error.",
    "Parse each manifest to extract dependency names and versions",
    "Build cross-repo dependency graph: map each dependency to all repos and versions that use it",
    "Flag version divergences: same package used at different versions across repos",
    "Store results via juggler_setec_put with key from outputs.setecKey",
    "Log completion via juggler_audit_log"
  ],
  "outputs": {
    "setecKey": "remotejuggler/campaigns/oc-dep-audit",
    "issueLabels": [
      "campaign",
      "dependency-audit"
    ],
    "issueRepo": "tinyland-inc/remote-juggler"
  },
  "guardrails": {
    "maxDuration": "30m",
    "readOnly": true,
    "aiApiBudget": {
      "maxTokens": 100000
    }
  },
  "feedback": {
    "createIssues": true,
    "createPRs": false,
    "closeResolvedIssues": true
  },
  "metrics": {
    "successCriteria": "All target repos scanned, dependency graph built, version divergences identified",
    "kpis": [
      "repos_scanned",
      "manifests_found",
      "total_dependencies",
      "version_divergences"
    ]
  }
}
