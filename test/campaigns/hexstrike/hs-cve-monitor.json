{
  "id": "hs-cve-monitor",
  "name": "CVE Monitor",
  "description": "Scans dependency manifests (go.mod, pyproject.toml, Cargo.toml, package.json) across all target repos and checks against NVD, GitHub Advisory Database, and OSV for known vulnerabilities. Classifies by CVSS severity.",
  "agent": "hexstrike-ai",
  "trigger": {
    "schedule": "0 3 * * *",
    "event": "manual"
  },
  "targets": [
    {
      "forge": "github",
      "org": "tinyland-inc",
      "repo": "remote-juggler",
      "branch": "main"
    },
    {
      "forge": "gitlab",
      "org": "tinyland/projects",
      "repo": "tinyland-auth",
      "branch": "main"
    },
    {
      "forge": "gitlab",
      "org": "tinyland",
      "repo": "outbot-ci",
      "branch": "main"
    },
    {
      "forge": "gitlab",
      "org": "tinyland",
      "repo": "tinyland.dev",
      "branch": "main"
    }
  ],
  "tools": [
    "github_fetch",
    "juggler_setec_get",
    "juggler_setec_put",
    "juggler_setec_list",
    "juggler_audit_log",
    "juggler_campaign_status",
    "juggler_resolve_composite"
  ],
  "process": [
    "For each target repository, fetch dependency manifests: go.mod, pyproject.toml, Cargo.toml, package.json, package-lock.json",
    "Parse each manifest to extract dependency names and versions",
    "For each dependency, check GitHub Advisory Database via github_fetch (GET /advisories?ecosystem=&package=)",
    "Cross-reference with NVD and OSV databases where possible via public APIs",
    "Classify each CVE by CVSS v3.1 score: critical (9.0+), high (7.0-8.9), medium (4.0-6.9), low (0.1-3.9)",
    "Generate findings for each CVE with: package name, current version, fixed version (if available), CVSS score, advisory URL",
    "Store results in Setec and create/close issues for CVEs based on feedback config",
    "Return structured JSON with KPIs: manifests_scanned, cves_critical, cves_high, cves_medium, cves_low"
  ],
  "outputs": {
    "setecKey": "remotejuggler/campaigns/hs-cve-monitor",
    "issueLabels": [
      "security",
      "campaign",
      "cve"
    ],
    "issueRepo": "tinyland-inc/remote-juggler"
  },
  "guardrails": {
    "maxDuration": "30m",
    "readOnly": true,
    "killSwitch": "remotejuggler/campaigns/global-kill",
    "aiApiBudget": {
      "maxTokens": 60000
    }
  },
  "feedback": {
    "createIssues": true,
    "createPRs": false,
    "closeResolvedIssues": true
  },
  "metrics": {
    "successCriteria": "All manifests scanned, CVEs classified and reported",
    "kpis": [
      "manifests_scanned",
      "cves_critical",
      "cves_high",
      "cves_medium",
      "cves_low"
    ]
  }
}
