{
  "id": "hs-gateway-pentest",
  "name": "rj-gateway Attack Surface Testing",
  "description": "Performs automated penetration testing against rj-gateway endpoints. Tests authentication bypass, SSRF via /resolve, injection via MCP tool parameters, oversized payloads, and verifies audit log captures all attempts.",
  "agent": "hexstrike-ai",
  "trigger": {
    "event": "push",
    "pathFilters": [
      "gateway/*.go"
    ]
  },
  "targets": [
    {
      "forge": "github",
      "org": "tinyland-inc",
      "repo": "remote-juggler",
      "branch": "main"
    }
  ],
  "tools": [
    "juggler_resolve_composite",
    "juggler_audit_log",
    "juggler_campaign_status",
    "juggler_setec_put"
  ],
  "process": [
    "Enumerate all rj-gateway endpoints: POST /mcp, GET /mcp/sse, GET /health, POST /resolve, GET /audit, /setec/*",
    "Test each endpoint with authentication edge cases: no auth headers, invalid auth, expired tokens, malformed Tailscale identity headers",
    "Attempt SSRF via POST /resolve with crafted queries: internal IP addresses (169.254.169.254, 10.0.0.0/8), file:// URLs, gopher:// URLs, DNS rebinding payloads",
    "Attempt injection via MCP tool parameters: command injection (;, |, $(), backticks), path traversal (../, %2e%2e/), JSON injection (deeply nested objects, prototype pollution patterns)",
    "Send oversized payloads: >1MB request bodies, deeply nested JSON (>100 levels), extremely long string values, requests with >1000 headers",
    "Verify audit log captures every attempt including denials via juggler_audit_log; check for audit gaps where requests were processed but not logged",
    "Test ACL grant enforcement: attempt admin operations (setec_put, campaign escalation) with reader-role identity. Generate pentest report with CVSS scores and store in Setec via juggler_setec_put"
  ],
  "outputs": {
    "setecKey": "remotejuggler/campaigns/hs-gateway-pentest",
    "pvcPath": "/results/gateway-pentest",
    "issueLabels": [
      "campaign",
      "security",
      "pentest"
    ],
    "issueRepo": "tinyland-inc/remote-juggler"
  },
  "guardrails": {
    "maxDuration": "15m",
    "readOnly": true,
    "aiApiBudget": {
      "maxTokens": 80000
    }
  },
  "feedback": {
    "createIssues": true,
    "createPRs": false,
    "closeResolvedIssues": false
  },
  "metrics": {
    "successCriteria": "All endpoints tested, no auth bypass found, audit log captures all attempts",
    "kpis": [
      "endpoints_tested",
      "auth_bypass_found",
      "ssrf_found",
      "injection_found",
      "audit_gaps",
      "findings_critical",
      "findings_high",
      "findings_medium"
    ]
  }
}
